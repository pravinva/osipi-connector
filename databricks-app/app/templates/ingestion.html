<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }}</title>
    <link rel="stylesheet" href="/static/css/pi_style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <link rel="icon" type="image/x-icon" href="/static/images/favicon.ico">
</head>
<body>
    <header class="pi-header">
        <div class="container">
            <div class="logo-section">
                <div class="pi-logo">PI</div>
                <h1>Lakehouse Ingestion Dashboard</h1>
            </div>
            <div class="nav-links">
                <a href="/" class="nav-link">Home</a>
                <a href="/docs" class="nav-link">API Docs</a>
                <a href="/piwebapi" class="nav-link">PI Web API</a>
            </div>
        </div>
    </header>

    <main class="container dashboard">
        <!-- Status KPIs -->
        <section class="kpi-grid">
            <div class="kpi-card status">
                <div class="kpi-icon">üü¢</div>
                <div class="kpi-content">
                    <div class="kpi-label">System Status</div>
                    <div class="kpi-value" id="status">Loading...</div>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon">‚è±Ô∏è</div>
                <div class="kpi-content">
                    <div class="kpi-label">Last Run</div>
                    <div class="kpi-value" id="last_run">--</div>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon">üìä</div>
                <div class="kpi-content">
                    <div class="kpi-label">Rows (Last Hour)</div>
                    <div class="kpi-value" id="rows_last_hour">--</div>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon">üè∑Ô∏è</div>
                <div class="kpi-content">
                    <div class="kpi-label">Active Tags</div>
                    <div class="kpi-value" id="tags_ingested">--</div>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon">üìÅ</div>
                <div class="kpi-content">
                    <div class="kpi-label">Event Frames</div>
                    <div class="kpi-value" id="event_frames">--</div>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon">‚úÖ</div>
                <div class="kpi-content">
                    <div class="kpi-label">Data Quality</div>
                    <div class="kpi-value" id="quality_score">--</div>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon">‚ö°</div>
                <div class="kpi-content">
                    <div class="kpi-label">Avg Latency</div>
                    <div class="kpi-value" id="avg_latency">--</div>
                </div>
            </div>

            <div class="kpi-card">
                <div class="kpi-icon">üîÑ</div>
                <div class="kpi-content">
                    <div class="kpi-label">Active Pipelines</div>
                    <div class="kpi-value" id="active_pipelines">--</div>
                </div>
            </div>
        </section>

        <!-- Charts -->
        <section class="chart-grid">
            <div class="chart-card">
                <h3>Ingestion Rate (Last Hour)</h3>
                <canvas id="rowsChart"></canvas>
            </div>

            <div class="chart-card">
                <h3>Tags by Plant</h3>
                <canvas id="tagsChart"></canvas>
            </div>
        </section>

        <!-- Pipeline Health -->
        <section class="pipeline-section">
            <h3>Pipeline Health</h3>
            <div id="pipeline_health" class="pipeline-grid">
                <!-- Populated by JavaScript -->
            </div>
        </section>

        <!-- Recent Events -->
        <section class="events-section">
            <h3>Recent Events</h3>
            <div id="recent_events" class="events-list">
                <!-- Populated by JavaScript -->
            </div>
        </section>
    </main>

    <footer class="pi-footer">
        <div class="container">
            <div class="footer-bottom">
                <p>PI Lakehouse Ingestion Dashboard | Data refreshes every 30 seconds</p>
            </div>
        </div>
    </footer>

    <script src="/static/js/dashboard.js"></script>
</body>
</html>
