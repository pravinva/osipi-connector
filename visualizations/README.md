# OSIPI Connector Visualizations

Visual representations for hackathon demos - no need to access Databricks workspace!

## Quick Start

### One-Click Demo Generation

```bash
# Generate all visualizations
python visualizations/demo_runner.py

# Interactive mode (view visualizations one by one)
python visualizations/demo_runner.py --interactive
```

## Available Visualizations

### 1. System Architecture Diagram
**File:** `architecture_diagram.py`

Shows end-to-end system architecture:
- OSIPI PI Server → Python Connector → Databricks Lakehouse
- Component relationships
- Technology stack
- Performance metrics

```bash
# Generate architecture diagram
python visualizations/architecture_diagram.py

# Show immediately (don't just save)
python visualizations/architecture_diagram.py --show

# Generate data flow diagram
python visualizations/architecture_diagram.py --dataflow

# Generate both
python visualizations/architecture_diagram.py --all
```

**Output:**
- `output/architecture_diagram.png` - Main system architecture
- `output/data_flow_diagram.png` - Detailed data flow with lateness handling

---

### 2. Live Dashboard
**File:** `live_dashboard.py`

Real-time dashboard showing actual data from mock PI server:
- AF hierarchy visualization (from real mock data)
- Live data flow statistics
- System metrics
- Tag counts and status

**Prerequisites:** Mock PI server must be running
```bash
# Terminal 1: Start mock server
python tests/mock_pi_server.py

# Terminal 2: Run dashboard
python visualizations/live_dashboard.py

# ASCII terminal version
python visualizations/live_dashboard.py --ascii
```

**Output:**
- Animated dashboard (updates every 2 seconds)
- `output/live_dashboard_snapshot.png` (via demo_runner)

---

### 3. Late Data Detection Visualization
**File:** `late_data_viz.py`

Shows enhanced late data handling capabilities:
- Lateness category distribution
- Timeline visualization
- Proactive vs reactive comparison
- AVEVA Connect feature comparison

```bash
# Generate visualization
python visualizations/late_data_viz.py

# Show immediately
python visualizations/late_data_viz.py --show

# Terminal metrics dashboard
python visualizations/late_data_viz.py --metrics
```

**Output:**
- `output/late_data_detection.png` - Comprehensive visualization
- `output/metrics_report.txt` - Text-based metrics

---

### 4. AF Hierarchy Visualizer
**File:** `af_hierarchy_visualizer.py`

Visualizes OSIPI AF hierarchy from mock server:
- Tree structure with databases, elements, attributes
- Network graph visualization
- ASCII tree for terminal

```bash
# Generate visualizations (both ASCII and graph)
python visualizations/af_hierarchy_visualizer.py

# Show graph immediately
python visualizations/af_hierarchy_visualizer.py --show
```

**Output:**
- ASCII tree (terminal)
- `output/af_hierarchy.png` - Network graph

---

## Demo Runner Features

The `demo_runner.py` orchestrates all visualizations:

### Full Generation Mode
```bash
python visualizations/demo_runner.py
```

Generates:
1. ✅ Architecture diagrams (system + data flow)
2. ✅ Late data detection visualization
3. ✅ Live dashboard snapshot (if server running)
4. ✅ Metrics report

### Interactive Mode
```bash
python visualizations/demo_runner.py --interactive
```

Menu options:
1. View architecture diagram
2. View data flow diagram
3. View late data detection
4. View live dashboard (animated)
5. Show metrics report
6. Generate all & exit

---

## For Hackathon Judges

These visualizations let you see the entire system **without accessing Databricks workspace**:

### What Judges Can See Locally

1. **System Architecture** - How OSIPI connects to Databricks
2. **Real Data Flow** - Actual tags and values from mock PI server
3. **Late Data Handling** - Enhanced detection matching AVEVA Connect
4. **Performance Metrics** - Validated at scale (100K+ tags)

### Running the Demo

**Option 1: Pre-Generated Images** (fastest)
```bash
# Generate once
python visualizations/demo_runner.py

# Show judges the images in output/
ls -lh visualizations/output/
```

**Option 2: Live Interactive Demo** (most impressive)
```bash
# Terminal 1: Mock server
python tests/mock_pi_server.py

# Terminal 2: Live dashboard
python visualizations/live_dashboard.py

# Or use interactive mode
python visualizations/demo_runner.py --interactive
```

---

## Output Files

All visualizations saved to `visualizations/output/`:

| File | Description | Generated By |
|------|-------------|--------------|
| `architecture_diagram.png` | System architecture | demo_runner or architecture_diagram.py |
| `data_flow_diagram.png` | Detailed data flow | demo_runner or architecture_diagram.py |
| `late_data_detection.png` | Late data visualization | demo_runner or late_data_viz.py |
| `af_hierarchy.png` | AF hierarchy graph | af_hierarchy_visualizer.py |
| `live_dashboard_snapshot.png` | Dashboard snapshot | demo_runner (requires mock server) |
| `metrics_report.txt` | Text metrics report | demo_runner |

---

## Dependencies

All visualization scripts require:
```bash
pip install matplotlib networkx requests numpy
```

Already included in project's `requirements.txt`.

---

## Customization

### Change Mock PI Server Port

If your mock server runs on different port:

```python
# In any visualization script
dashboard = LiveDashboard(pi_server_url="http://localhost:8000")
```

### Generate More Sample Data

For late data visualization:

```python
# In late_data_viz.py
records = viz.generate_sample_data(1000)  # Default: 100
```

### Databricks Branding

All visualizations use official Databricks colors:
- Lava: #FF3621 (red)
- Cyan: #00A8E1 (blue)
- Navy: #1B3139 (dark blue)

---

## Troubleshooting

### "Mock server not running"
```bash
# Start mock server first
python tests/mock_pi_server.py

# Check it's running
curl http://localhost:5050/piwebapi
```

### "No module named matplotlib"
```bash
pip install matplotlib networkx
```

### Images not displaying
```bash
# Add --show flag
python visualizations/architecture_diagram.py --show

# Or use interactive mode
python visualizations/demo_runner.py --interactive
```

---

## For Presentation

### Recommended Flow

1. **Start:** Show architecture diagram
   - "Here's how we connect OSIPI to Databricks"

2. **Demo:** Run live dashboard
   - "Let's see actual data flowing from mock PI server"
   - Show AF hierarchy with real plant names
   - Show live tag values updating

3. **Highlight:** Late data detection
   - "Enhanced handling matching AVEVA Connect"
   - Show proactive vs reactive comparison
   - "10x-100x cost savings"

4. **Metrics:** Show performance numbers
   - "136 tests passing"
   - "2.4K records/sec throughput"
   - "Validated at 100K+ tags"

### Presentation Tips

- **Don't show code** - use visualizations instead
- **Keep mock server running** - for live demo credibility
- **Have backup images** - in case live demo has issues
- **Time budget:** 2-3 minutes for full walkthrough

---

## Credits

Built for OSIPI → Databricks connector hackathon demo.

Visualizations designed to showcase:
- ✅ Production-ready architecture
- ✅ Real data ingestion (via mock)
- ✅ Enhanced late data handling (matches AVEVA Connect)
- ✅ Cost efficiency (10x-100x savings)
